<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>사용자 메인 페이지</title>
</head>
<body>
<h1>환영합니다, <span id="username">사용자</span>님!</h1>
<p>여기는 로그인한 사용자를 위한 메인 페이지입니다.</p>

<!-- 관리자 전용 버튼 (기본 숨김) -->
<button id="adminBtn" style="display:none;" onclick="location.href='/admin.html'">
  관리자 페이지
</button>

<button id="logoutBtn">로그아웃</button>

<script>
  // 페이지 로드 시 사용자 정보 불러오기
  fetch("/api/users/user-info")
    .then(res => res.json())
    .then(data => {
      if (data.username) {
        document.getElementById("username").innerText = data.username;
      }
      if (data.role.includes("ADMIN")) {
      document.getElementById("adminBtn").style.display = "inline-block";
      }
    })
    .catch(err => console.error("사용자 정보 가져오기 실패:", err));

  // 로그아웃
  document.getElementById("logoutBtn").addEventListener("click", async () => {
    const res = await fetch("/logout", { method: "POST" });
    if (res.ok) {
      window.location.href = "/login.html";
    } else {
      alert("로그아웃 실패");
    }
  });
</script>
</body>
</html>